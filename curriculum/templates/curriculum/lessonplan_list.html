{% extends "firstbyte/base.html" %}
{% load formatting_extras %}
{% load static %}
{% block title %}List of Lesson Plans{% endblock %}
{% block head %}
    {% load render_bundle from webpack_loader %}
    {% render_bundle 'starRating' %}
{% endblock %}
{% block content %}
    <div class="container">
        <form method="get">
            <div class="row mb-3">
                <div class="col d-flex form-inline">
                    <div class="flex-fill pr-4">
                        <div class="input-group">
                            <input name="q" type="text" class="form-control" placeholder="Search Curricula" value="{% if form.q.value %}{{ form.q.value }}{% endif %}"/>
                            <div class="input-group-append">
                                <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> Search</button>
                            </div>
                        </div>
                    </div>
                    <div class="pr-4">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">{{ form.sort_by.label }}</span>
                            </div>
                            {{ form.sort_by }}
                        </div>
                    </div>
                    <div>
                        <a class="btn btn-outline-primary" data-toggle="collapse" href="#advancedSearchControls" role="button" aria-expanded="false" aria-controls="collaadvancedSearchControlspseExample">Advanced Search Options</a>
                    </div>
                </div>
            </div>
            <div class="collapse {% if show_advanced_search_options %}show{% endif %} row" id="advancedSearchControls">
                <div class="col mb-3">
                    <div class="btn-group btn-group-toggle" data-toggle="buttons">
                        <label class="btn btn-primary {% if 'ES' in form.grade_level.value %}active{% endif %}">
                            <input type="checkbox" name="grade_level" value="ES" autocomplete="off" {% if 'ES' in form.grade_level.value %}checked{% endif %} /> Elementary School
                        </label>
                        <label class="btn btn-primary {% if 'MS' in form.grade_level.value %}active{% endif %}">
                            <input type="checkbox" name="grade_level" value="MS" autocomplete="off" {% if 'MS' in form.grade_level.value %}checked{% endif %} /> Middle School
                        </label>
                        <label class="btn btn-primary {% if 'HS' in form.grade_level.value %}active{% endif %}">
                            <input type="checkbox" name="grade_level" value="HS" autocomplete="off" {% if 'HS' in form.grade_level.value %}checked{% endif %} /> High School
                        </label>
                        <label class="btn btn-primary {% if 'U' in form.grade_level.value %}active{% endif %}">
                            <input type="checkbox" name="grade_level" value="U" autocomplete="off" {% if 'U' in form.grade_level.value %}checked{% endif %} /> Post-secondary
                        </label>
                    </div>
                </div>
                <div class="col mb-3">
                    <div class="btn-group-toggle" data-toggle="buttons">
                        <label class="btn btn-primary {% if form.web_only.value %}active{% endif %}" for="{{ form.web_only.id_for_label }}">
                            <input type="checkbox" autocomplete="off" name="{{ form.web_only.name }}" {% if form.web_only.value %}checked{% endif %} /><i class="fab fa-chrome"></i> {{ form.web_only.label }}
                        </label>
                    </div>
                </div>
            </div>
        </form>
        {% for lessonplan in object_list %}
            <div class="row">
                <div class="col">
                    <div class="card mb-3">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <h4 class="flex-fill card-title">{{ lessonplan.title }}</h4>
                                {% if lessonplan.web_only %}
                                    <p class="pr-4" title="Chromebook compatible"><i class="text-right fab fa-chrome"></i></p>
                                {% endif %}
                                {% if lessonplan.average_rating %}
                                    <p class="stars text-primary text-right" data-average-rating="{{ lessonplan.average_rating }}" >
                                        <i class="fa-star" aria-hidden="true"></i>
                                        <i class="fa-star" aria-hidden="true"></i>
                                        <i class="fa-star" aria-hidden="true"></i>
                                        <i class="fa-star" aria-hidden="true"></i>
                                        <i class="fa-star" aria-hidden="true"></i>
                                    </p>
                                {% else %}
                                    <p class="stars text-primary text-right" data-average-rating="{{ lessonplan.average_rating }}" >
                                        <i class="far fa-star" aria-hidden="true"></i>
                                        <i class="far fa-star" aria-hidden="true"></i>
                                        <i class="far fa-star" aria-hidden="true"></i>
                                        <i class="far fa-star" aria-hidden="true"></i>
                                        <i class="far fa-star" aria-hidden="true"></i>
                                    </p>
                                {% endif %}
                            </div>
                            <p class="card-text">{{ lessonplan.summary }}</p>
                        </div>
                        <div class="card-footer d-flex flex-wrap align-items-center justify-content-between">
                            <div>
                                <i class="far fa-calendar-alt"></i>
                                <span class="sr-only">Timeline: </span>
                                <span>{% number_to_words lessonplan.num_classes True %} {% format_duration lessonplan.single_class_time %} classes</span>
                            </div>
                            <div>
                                <i class="fas fa-search"></i>
                                <span class="sr-only">Preparation timeline: </span>
                                <span>{% format_duration lessonplan.total_prep_time %} total prep time</span>
                            </div>
                            <div>
                                <i class="fas fa-thermometer-half"></i>
                                <span class="sr-only">Works best for </span>
                                <span>{{ lessonplan.get_grade_level_display }}</span>
                            </div>
                            <div>
                                <a class="btn btn-primary" href="{{ lessonplan.get_absolute_url }}">Detailed View</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}
